---
id: troubleshooting-bible
title: Troubleshooting Bible
sidebar_position: 2
description: A curated list of common errors and solutions for Physical AI development, covering Ubuntu, ROS 2, NVIDIA, and Isaac Sim.
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# Troubleshooting Bible

Welcome to the Troubleshooting Bible, your guide to resolving the most common issues you might encounter while setting up your Physical AI workstation. This appendix is a living document that will be updated as new issues and solutions are discovered.

## NVIDIA & GPU Driver Issues

### 1. `nvidia-smi` command not found

-   **Symptom**: You see `nvidia-smi: command not found` in your terminal.
-   **Root Cause**: The NVIDIA driver is not installed or its installation path is not in your system's `PATH` environment variable.
-   **Solution**:
    1.  Follow the driver installation steps in Chapter 2.
    2.  Run `sudo ubuntu-drivers autoinstall` to get the recommended driver.
    3.  Reboot your system after installation: `sudo reboot`.

### 2. Isaac Sim shows a black screen or fails to launch

-   **Symptom**: The Isaac Sim window opens but the viewport is black, or the application crashes immediately.
-   **Root Cause**: This is often caused by an incompatibility between the windowing system and Isaac Sim. It typically happens on systems using Wayland by default.
-   **Solution**: Switch from Wayland to X11.
    1.  Log out of your Ubuntu session.
    2.  On the login screen, click the gear icon (⚙️) next to the "Sign In" button.
    3.  Select "Ubuntu on Xorg" or "Ubuntu (X11)" from the menu.
    4.  Log in and try launching Isaac Sim again.

### 3. "Failed to initialize NVML: Driver/library version mismatch"

-   **Symptom**: `nvidia-smi` fails with a version mismatch error.
-   **Root Cause**: This usually happens after a kernel update. The running kernel module for the NVIDIA driver is different from the user-space libraries.
-   **Solution**:
    1.  Reinstall the NVIDIA driver: `sudo apt-get install --reinstall nvidia-driver-<your_version>`.
    2.  A simpler, more robust solution is often to purge and reinstall:
        ```bash
        sudo apt purge nvidia-*
        sudo ubuntu-drivers autoinstall
        sudo reboot
        ```

### 4. CUDA version not found with `nvcc --version`

-   **Symptom**: The `nvcc` command is not found, even after installing the CUDA Toolkit.
-   **Root Cause**: The CUDA bin directory is not in your `PATH`.
-   **Solution**: Add CUDA to your `.bashrc` file.
    ```bash
    echo 'export PATH=/usr/local/cuda/bin:$PATH' >> ~/.bashrc
    echo 'export LD_LIBRARY_PATH=/usr/local/cuda/lib64:$LD_LIBRARY_PATH' >> ~/.bashrc
    source ~/.bashrc
    ```
    *Note: Replace `/usr/local/cuda` with your specific CUDA version if needed, e.g., `/usr/local/cuda-12.4`.*

### 5. Isaac Sim complains about unsupported driver

-   **Symptom**: Isaac Sim fails to launch, with a log message indicating the driver version is not supported.
-   **Root Cause**: The installed NVIDIA driver is too old for the version of Isaac Sim you are using.
-   **Solution**: Upgrade to the driver version recommended in the Isaac Sim release notes (usually available on the NVIDIA developer website). Use the PPA for the latest drivers:
    ```bash
    sudo add-apt-repository ppa:graphics-drivers/ppa -y
    sudo apt update
    sudo apt upgrade
    ```

## ROS 2 Issues

### 6. ROS 2 commands not found (`ros2 topic list`, etc.)

-   **Symptom**: You see `ros2: command not found`.
-   **Root Cause**: The ROS 2 setup script has not been sourced in your terminal session.
-   **Solution**:
    1.  Source the setup file for your ROS 2 distribution (e.g., Jazzy):
        ```bash
        source /opt/ros/jazzy/setup.bash
        ```
    2.  For a permanent fix, add this line to the end of your `~/.bashrc` file:
        ```bash
        echo "source /opt/ros/jazzy/setup.bash" >> ~/.bashrc
        ```

### 7. ROS 2 nodes cannot discover each other

-   **Symptom**: Your publisher is running, but your subscriber sees no messages. `ros2 topic list` might hang or show incomplete information.
-   **Root Cause**: This is a common issue with the ROS 2 middleware (DDS) configuration, often related to network interfaces or firewalls.
-   **Solution**: Explicitly set a reliable DDS implementation. CycloneDDS is a good default.
    1.  Install it: `sudo apt install ros-jazzy-rmw-cyclonedds-cpp`
    2.  Set the environment variable in your `~/.bashrc`:
        ```bash
        echo "export RMW_IMPLEMENTATION=rmw_cyclonedds_cpp" >> ~/.bashrc
        source ~/.bashrc
        ```

### 8. Colcon build fails with missing dependencies

-   **Symptom**: `colcon build` stops with an error like "package 'x' not found".
-   **Root Cause**: Your workspace has packages that depend on other ROS packages not yet installed on your system.
-   **Solution**: Use `rosdep` to automatically install missing dependencies.
    1.  Navigate to the root of your ROS 2 workspace (e.g., `~/ros2_ws`).
    2.  Run `rosdep` to check for and install dependencies:
        ```bash
        sudo apt install python3-rosdep -y # If not already installed
        sudo rosdep init
        rosdep update
        rosdep install --from-paths src --ignore-src -r -y
        ```
    3.  Retry the `colcon build`.

### 9. "Could not find a package configuration file" (colcon)

-   **Symptom**: `colcon build` fails with an error mentioning a missing package configuration file for a specific dependency.
-   **Root Cause**: A required dependency is not installed or its setup script has not been sourced.
-   **Solution**:
    1.  Identify the missing package from the error message.
    2.  Install it using `apt`: `sudo apt install ros-jazzy-<package-name>`.
    3.  If it's a package from another workspace, you need to source that workspace's `install/setup.bash` file before building the new one.

### 10. `rosdep update` fails with URL errors

-   **Symptom**: `rosdep update` fails, often with errors about being unable to download resource lists.
-   **Root Cause**: Network issues, firewalls, or (rarely) an outage of the `raw.githubusercontent.com` domain.
-   **Solution**: Try again after checking your network connection. If behind a corporate firewall, you may need to configure proxy settings for `rosdep`.

## Isaac Sim & ROS 2 Integration Issues

### 11. No ROS 2 topics are published from Isaac Sim

-   **Symptom**: You launch Isaac Sim with the ROS 2 bridge enabled, but `ros2 topic list` does not show any topics from the simulator (like `/clock` or `/tf`).
-   **Root Cause**: The ROS 2 environment is not correctly sourced in the shell where Isaac Sim is launched, or there's a DDS mismatch.
-   **Solution**:
    1.  Ensure you have sourced your main ROS 2 setup file (`source /opt/ros/jazzy/setup.bash`).
    2.  Ensure you have set `export RMW_IMPLEMENTATION=rmw_cyclonedds_cpp`.
    3.  Launch Isaac Sim from a terminal where these environment variables are active. Do not use a desktop shortcut unless you have configured it to source the files.

### 12. "ImportError: No module named 'rclpy'" in Isaac Sim

-   **Symptom**: Isaac Sim's Python scripting console shows an import error for `rclpy` or other ROS 2 modules.
-   **Root Cause**: Isaac Sim uses its own bundled Python environment, which does not know about your system's ROS 2 installation.
-   **Solution**: Launch Isaac Sim from a terminal where ROS 2 has been sourced. The Isaac Sim startup script (`isaac-sim.sh`) is designed to pass the correct Python paths to its internal environment.

### 13. Simulation runs much slower than real-time

-   **Symptom**: The "RTF" (Real-Time Factor) in Isaac Sim is very low (e.g., 0.1).
-   **Root Cause**: The scene is too complex for your GPU, or physics settings are too demanding.
-   **Solution**:
    1.  **Reduce Rendering Quality**: In Isaac Sim, go to `Render Settings -> Presets` and choose a lower quality setting.
    2.  **Simplify Physics**: In the `PhysicsScene` properties, increase the `Time-Steps Per Second` or decrease the number of solver iterations.
    3.  **Close other GPU-intensive applications.**
    4.  Check that your GPU is not thermal throttling using `nvidia-smi`.

### 14. Robot model (URDF) has incorrect orientation or collision

-   **Symptom**: Your robot model appears sideways in Isaac Sim, or its parts fall through the floor.
-   **Root Cause**: A mismatch in coordinate systems (ROS uses Z-up, some modeling software uses Y-up) or improperly defined collision meshes in the URDF.
-   **Solution**:
    1.  **Orientation**: Ensure your URDF's base link has the correct orientation. You may need to add a world link with a rotation to correct it.
    2.  **Collision**: Verify that every `<link>` in your URDF has a `<collision>` tag with a defined geometry. For complex shapes, use simple primitives (box, cylinder, sphere) for collision to start.

### 15. "Cannot open shared object file" when running Python scripts

-   **Symptom**: A Python script in Isaac Sim fails, unable to find a `.so` file.
-   **Root Cause**: A required library is not in the `LD_LIBRARY_PATH`.
-   **Solution**: Add the required library path to the `LD_LIBRARY_PATH` in your `~/.bashrc` file and restart the terminal.
    ```bash
    echo 'export LD_LIBRARY_PATH=/path/to/your/lib:$LD_LIBRARY_PATH' >> ~/.bashrc
    source ~/.bashrc
    ```

## Python & General Environment Issues

### 16. `pip install` fails with "Could not build wheels"

-   **Symptom**: `pip` fails while trying to install a package, often a scientific computing library like `numpy` or `scipy`.
-   **Root Cause**: The package needs to be compiled from source, but you are missing the required system-level build dependencies (like a C++ compiler or Python development headers).
-   **Solution**: Install the Python development files and build essentials.
    ```bash
    sudo apt update
    sudo apt install python3-dev python3-pip build-essential -y
    ```

### 17. "Permission denied" when running a script

-   **Symptom**: You try to run a script (e.g., `./my_script.sh`) and get a "Permission denied" error.
-   **Root Cause**: The script does not have execute permissions.
-   **Solution**: Add execute permissions using `chmod`.
    ```bash
    chmod +x your_script_name.sh
    ```

### 18. Out of disk space

-   **Symptom**: `apt` or other tools fail with "No space left on device".
-   **Root Cause**: Your hard drive or partition is full. Isaac Sim, ROS, and CUDA can take up over 100 GB.
-   **Solution**:
    1.  Clean the `apt` cache: `sudo apt clean`
    2.  Remove old log files from `/var/log`.
    3.  Use a disk usage analyzer like `baobab` (`sudo apt install baobab`) to find large files or directories that can be removed.

### 19. "E: Unable to locate package"

-   **Symptom**: `sudo apt install <package>` fails because the package cannot be found.
-   **Root Cause**: Your package lists are out of date, or you haven't added the correct repository (PPA).
-   **Solution**:
    1.  Always run `sudo apt update` before installing new packages.
    2.  If it's a ROS package, ensure you have the ROS 2 repository added and sourced correctly.
    3.  If it's a special driver or software, you may need to add a PPA first.

### 20. `colcon` commands are slow

-   **Symptom**: `colcon build` or other `colcon` commands take a very long time to start.
-   **Root Cause**: `colcon` can be slow to discover packages in very large workspaces or when many environment hooks are present.
-   **Solution**: Install the `colcon-argcomplete` package, which can sometimes speed up discovery.
    ```bash
    sudo apt install python3-colcon-argcomplete
    ```

## URDF and Robot Model Issues

### 21. URDF fails to parse with "Error parsing XML"

-   **Symptom**: You see an error like `Error reading end tag`, `mismatched tag`, or `failed to load robot model`.
-   **Root Cause**: A syntax error in your URDF file, like an unclosed tag, a typo in a tag name, or invalid characters.
-   **Solution**:
    1.  Use a linter or an IDE with XML validation to find the error.
    2.  Run `check_urdf <your_robot>.urdf` to get a detailed report.
    3.  Carefully check your `<link>`, `<joint>`, and `<robot>` tags to ensure they are all properly nested and closed.

### 22. Robot model is a jumbled pile of links in Rviz2 or Isaac Sim

-   **Symptom**: The robot model loads, but all the links are overlapping at the world origin instead of forming a coherent structure.
-   **Root Cause**: The `robot_state_publisher` is not running, or the TF (Transform) data is not being published correctly.
-   **Solution**:
    1.  Ensure `robot_state_publisher` is included in your launch file.
    2.  Verify that it's receiving the `joint_states` topic. Use `ros2 topic echo /joint_states`.
    3.  If `joint_states` is empty, you need a node (like `joint_state_publisher_gui`) to publish the joint states.
        ```xml
        <!-- In your launch file -->
        <node name="joint_state_publisher_gui" pkg="joint_state_publisher_gui" exec="joint_state_publisher_gui" />
        <node name="robot_state_publisher" pkg="robot_state_publisher" exec="robot_state_publisher">
            <param name="robot_description" value="your_urdf_content" />
        </node>
        ```

### 23. `TF Error: "base_link" passed to lookUpTransform argument target_frame does not exist.`

-   **Symptom**: Rviz2 or other nodes report TF errors indicating that frames are not connected.
-   **Root Cause**: The transform tree is incomplete. This usually means `robot_state_publisher` is not correctly processing your URDF or not running at all.
-   **Solution**:
    1.  Use `ros2 run tf2_tools view_frames` to generate a PDF of your TF tree and see what's missing.
    2.  Ensure your URDF has a single root link (often `base_link`) and all other links are connected via a chain of joints. There should be no "floating" links.

### 24. Incorrect joint types in URDF cause strange behavior

-   **Symptom**: The robot moves in unexpected ways. For example, a wheel spins around the wrong axis, or a leg bends sideways.
-   **Root Cause**: The joint type (`revolute`, `continuous`, `prismatic`, `fixed`) or its axis is defined incorrectly in the URDF.
-   **Solution**:
    1.  For wheels, use a `continuous` joint.
    2.  For joints with limits (like an elbow), use a `revolute` joint and define `<limit>` tags.
    3.  For sliding motion, use a `prismatic` joint.
    4.  The `<axis xyz="..." />` tag defines the axis of rotation or translation. `1 0 0` is the X-axis, `0 1 0` is the Y-axis, and `0 0 1` is the Z-axis.

### 25. Visual and collision models are not aligned

-   **Symptom**: The robot *looks* correct, but it interacts with the environment incorrectly (e.g., sinks into the floor, grasps objects from a distance).
-   **Root Cause**: The `<visual>` and `<collision>` tags for a link have different origins or geometries.
-   **Solution**:
    1.  For simple shapes, ensure the `<origin>` tag within both `<visual>` and `<collision>` is identical.
    2.  For complex meshes, it's a common practice to use a simplified version of the mesh for collision (a "convex hull"). Ensure the simplified mesh is generated and referenced correctly.
    3.  In Rviz2, you can visualize both the visual and collision models to debug discrepancies.

### 26. `xacro: command not found` or "invalid Xacro expression"

-   **Symptom**: You cannot launch your robot model, and the error mentions `xacro`.
-   **Root Cause**: Your URDF is written using the Xacro templating language (`.urdf.xacro`), but the `xacro` package is not installed or not being invoked correctly.
-   **Solution**:
    1.  Install the `xacro` package: `sudo apt install ros-jazzy-xacro`.
    2.  When loading the robot description in a launch file, you must use `xacro` to process the file first.
        ```python
        # In a Python launch file
        import xacro
        doc = xacro.process_file(xacro_file_path)
        robot_description = {'robot_description': doc.toxml()}
        ```

### 27. ROS 2 action server is not responding

-   **Symptom**: You send a goal to an action server, but it never transitions out of the "PENDING" state.
-   **Root Cause**: The action server might be stuck in its `execute_callback`, or the callback was never triggered.
-   **Solution**:
    1.  Use `ros2 action info /my_action` to see if the server is advertised.
    2.  Check the action server's logs for errors.
    3.  Ensure your action server is properly spinning (`rclpy.spin()`) and that the callbacks are registered correctly.

### 28. Gazebo plugins for ROS 2 are not loading

-   **Symptom**: Your robot model appears in Gazebo, but it doesn't respond to ROS 2 commands. You might see errors about missing plugins in the Gazebo console.
-   **Root Cause**: The Gazebo plugin (`libgazebo_ros_init.so`, `libgazebo_ros_diff_drive.so`, etc.) is not found or not correctly referenced in the URDF.
-   **Solution**:
    1.  Install the Gazebo ROS packages: `sudo apt install ros-jazzy-gazebo-ros-pkgs`.
    2.  Ensure your environment is sourced correctly so Gazebo can find the plugins.
    3.  In your URDF, make sure the `<plugin>` tag has the correct `filename` and `name`.

### 29. Rviz2 is not showing the robot model correctly

-   **Symptom**: Rviz2 shows "No transform" errors, or parts of the robot are missing or in the wrong place.
-   **Root Cause**: Incorrect `Fixed Frame` setting in Rviz2, or TF data is incomplete.
-   **Solution**:
    1.  In Rviz2's "Global Options", set the `Fixed Frame` to your robot's root link (e.g., `base_link` or `odom`).
    2.  Add a `RobotModel` display and set the `Robot Description` topic to `/robot_description`.
    3.  Add a `TF` display to visualize the transform tree and debug any missing links.

### 30. Link 'X' is not a valid link for this robot

-   **Symptom**: A node or tool complains that a link name is not part of the robot model.
-   **Root Cause**: A typo in the link name in your code or configuration, or the URDF loaded by `robot_state_publisher` is out of date.
-   **Solution**:
    1.  Double-check for typos. Link names are case-sensitive.
    2.  Use `ros2 topic echo /robot_description` to see the actual URDF being used by the system and verify the link name exists.
    3.  If you've recently changed your URDF, be sure to rebuild and relaunch.

## VLA & Voice Pipeline Issues

### 31. VLA model out of memory (OOM) errors

-   **Symptom**: The VLA model fails to load or run, with errors like `CUDA out of memory` or `RuntimeError: allocation failed`.
-   **Root Cause**: The model's size (parameters) exceeds your GPU's available VRAM.
-   **Solution**:
    1.  **Quantization**: Use 8-bit or 4-bit quantized versions of the model if available. Many frameworks (like Hugging Face Transformers) support this.
    2.  **Smaller Model**: Switch to a smaller VLA model (e.g., Octo-Base, a more compact version of OpenVLA).
    3.  **Batch Size**: Reduce the inference batch size to 1.
    4.  **Free VRAM**: Close other applications that might be using GPU memory.

### 32. VLA inference is too slow / high latency

-   **Symptom**: The robot takes a long time to react after receiving a visual input or command.
-   **Root Cause**: Model size, unoptimized inference pipeline, or limited GPU computational power.
-   **Solution**:
    1.  **Quantization**: Use quantized models (8-bit, 4-bit) for faster inference.
    2.  **GPU Upgrade**: Consider a more powerful GPU if continuous high-frequency inference is needed.
    3.  **Model Choice**: Use VLA models designed for low latency (e.g., π0 series, Gemini On-Device).
    4.  **Framework Optimization**: Use inference acceleration libraries (e.g., TensorRT for NVIDIA GPUs).

### 33. Incorrect VLA model output (wrong actions)

-   **Symptom**: The VLA model generates actions that are nonsensical or do not match the input prompt/visuals.
-   **Root Cause**: Model hasn't generalized well to your specific task, domain shift, or insufficient training data for a particular scenario.
-   **Solution**:
    1.  **Fine-tuning**: Fine-tune the VLA model on a small dataset of your specific robot and task.
    2.  **Prompt Engineering**: Refine your natural language prompts to be more specific and unambiguous.
    3.  **Data Augmentation**: Provide more diverse visual inputs during training if you are fine-tuning.
    4.  **Model Selection**: Experiment with different VLA models that may have better generalization capabilities for your use case.

### 34. Speech recognition (Whisper) not accurate

-   **Symptom**: The voice command is frequently transcribed incorrectly by the speech-to-text model.
-   **Root Cause**: Background noise, unclear pronunciation, model not trained on specific accents/vocabulary, or low-quality microphone.
-   **Solution**:
    1.  **Microphone Quality**: Use a high-quality, noise-canceling microphone.
    2.  **Environment**: Reduce background noise in the environment.
    3.  **Model Choice**: Use a larger Whisper model (e.g., `large-v2` instead of `base`) if VRAM permits, or a fine-tuned model for robotics commands.
    4.  **Clear Pronunciation**: Speak clearly and enunciate.

### 35. LLM command parsing errors

-   **Symptom**: The LLM correctly transcribes the voice command, but it fails to convert it into the correct sequence of robot actions or parameters.
-   **Root Cause**: Insufficient few-shot examples, ambiguity in the natural language, or the LLM's inability to reason about the physical world.
-   **Solution**:
    1.  **System Prompt**: Improve the system prompt to the LLM, providing clear instructions on the desired output format (e.g., JSON list of actions).
    2.  **Few-Shot Examples**: Provide more high-quality few-shot examples (input command, expected action sequence) to the LLM.
    3.  **Clarification**: Implement a mechanism for the LLM to ask clarifying questions if a command is ambiguous.
    4.  **Domain-Specific LLM**: Use an LLM fine-tuned for robotics control.

### 36. Voice pipeline end-to-end latency too high

-   **Symptom**: There's a noticeable delay (e.g., >3 seconds) between speaking a command and the robot initiating the action.
-   **Root Cause**: Cumulative latency from speech recognition, LLM parsing, VLA inference, and ROS 2 communication.
-   **Solution**:
    1.  **Smaller Models**: Use smaller, faster models for speech recognition (e.g., Distil-Whisper) and VLA inference (quantized models).
    2.  **Parallel Processing**: Run speech recognition and initial LLM parsing in parallel with other steps if possible.
    3.  **Edge Compute**: Ensure all components are running on powerful local hardware (e.g., RTX 4070 Ti, Jetson AGX Orin).
    4.  **Optimize ROS 2**: Ensure DDS is configured for low latency, and ROS 2 nodes are optimized.

### 37. Microphone not detected or working

-   **Symptom**: The voice pipeline cannot capture any audio input.
-   **Root Cause**: Incorrect audio input device selection, driver issues, or hardware malfunction.
-   **Solution**:
    1.  **Verify Hardware**: Check that the microphone is plugged in correctly and enabled in Ubuntu's sound settings.
    2.  **Device ID**: Explicitly specify the microphone device ID in your audio capture code.
    3.  **`pavucontrol`**: Use `pavucontrol` (`sudo apt install pavucontrol`) to manage PulseAudio settings and ensure the correct input device is selected and unmuted.
    4.  **Test**: Use `arecord -d 5 test.wav` to record a 5-second audio file and then play it back with `aplay test.wav` to test the microphone.

### 38. ROS 2 action sequence generation errors

-   **Symptom**: The final ROS 2 actions generated by the pipeline are syntactically incorrect or logically flawed for the robot.
-   **Root Cause**: The LLM's output format does not precisely match the expected ROS 2 action messages, or the VLA model generates actions outside the robot's capabilities.
-   **Solution**:
    1.  **Schema Enforcement**: Use Pydantic or similar libraries to strictly validate the LLM's output against your ROS 2 action message definitions.
    2.  **Robot Constraints**: Integrate robot-specific joint limits and kinematic constraints into the action generation logic.
    3.  **Error Handling**: Implement robust error handling and fallback mechanisms in the ROS 2 action client.

### 39. VLA model not loading correctly

-   **Symptom**: The script attempts to load a VLA model and fails with an error indicating missing files, incorrect format, or incompatible versions.
-   **Root Cause**: Model weights are corrupted, incorrect path to model files, mismatch between framework version and model, or missing dependencies.
-   **Solution**:
    1.  **Verify Download**: Ensure all model files (weights, configuration, tokenizer) have been downloaded completely and are not corrupted.
    2.  **Path Check**: Double-check the file path to the model directory.
    3.  **Dependencies**: Install all required Python packages (e.g., `transformers`, `torch`, `safetensors`).
    4.  **Framework Version**: Ensure your PyTorch/TensorFlow and `transformers` versions are compatible with the model.

### 40. Incorrect image input to VLA model

-   **Symptom**: The VLA model appears to process images, but its actions are not aligned with what is visually present in the scene.
-   **Root Cause**: Image preprocessing errors (wrong resolution, color space, normalization), incorrect camera feed, or lack of visual calibration.
-   **Solution**:
    1.  **Pre-processing**: Verify the image preprocessing pipeline matches the model's training requirements (e.g., resize to 224x224, normalize pixel values).
    2.  **Camera Calibration**: Ensure the camera is properly calibrated and the image is not distorted.
    3.  **Visualize Input**: Temporarily add code to save or display the image *after* preprocessing but *before* feeding it to the VLA model, to ensure it looks as expected.

## Sim-to-Real Transfer Issues

### 41. Policy trained in sim fails completely in real

-   **Symptom**: A policy that worked perfectly in simulation performs randomly or crashes the robot in the real world.
-   **Root Cause**: Significant reality gap that the policy could not overcome; severe domain shift.
-   **Solution**:
    1.  **Increase Domain Randomization**: Add more randomization to all relevant parameters in simulation (physics, visuals, sensor noise).
    2.  **Systematic Debugging**: Use the Sim-to-Real Debugging Flowchart to isolate the source of the discrepancy (sensor, actuator, physics, environment).
    3.  **Sim-to-Real Data**: Collect a small amount of real-world data and fine-tune the policy or use it for domain adaptation.

### 42. Sim-to-real performance degradation is too high

-   **Symptom**: The policy achieves high success in sim but only, for example, 50% success in the real world.
-   **Root Cause**: A subtle but persistent reality gap that reduces performance without causing complete failure.
-   **Solution**:
    1.  **Quantify the Gap**: Use metrics (e.g., state distribution mismatch, control signal discrepancy) to pinpoint the largest differences.
    2.  **Refine DR**: Identify which randomized parameters are most critical and expand their ranges or distributions.
    3.  **System Identification**: Use system identification techniques to update simulation parameters to more closely match the real robot.
    4.  **Calibrate Sensors/Actuators**: Ensure all real-world hardware is precisely calibrated.

### 43. Robot jitters or behaves erratically in real world

-   **Symptom**: The robot's movements are not smooth, it shakes, or it makes sudden, unintended movements.
-   **Root Cause**: High-frequency noise in real-world sensors, unmodeled delays, or control loop instability when combined with real-world physics.
-   **Solution**:
    1.  **Filtering**: Apply low-pass filters to noisy sensor data before feeding it to the policy.
    2.  **Control Loop Tuning**: Adjust PID gains or other low-level controller parameters on the real robot.
    3.  **Increase DR for Noise**: Train with more aggressive sensor noise randomization in simulation.
    4.  **Hardware Issues**: Check for loose connections, damaged sensors, or faulty actuators.

### 44. Sensor data mismatch between sim and real

-   **Symptom**: Visual inputs (e.g., camera images) from the real robot look significantly different from simulated ones, even after DR.
-   **Root Cause**: Unmodeled lighting, specular reflections, camera intrinsics/extrinsics, or material properties.
-   **Solution**:
    1.  **Visual DR**: Intensify randomization of textures, colors, lighting, and camera parameters in simulation.
    2.  **Calibrate Camera**: Perform a precise camera calibration for the real robot.
    3.  **Background Subtraction/Segmentation**: Use perception techniques to make the policy more robust to background changes.
    4.  **Real-to-Sim Transfer**: Generate synthetic images from real data to augment simulation training.

### 45. Actuator commands not executed correctly on real robot

-   **Symptom**: The robot's joints do not reach the commanded positions/velocities/torques, or they do so with significant delay or overshoot.
-   **Root Cause**: Differences in actuator dynamics, friction, or controller tuning between sim and real.
-   **Solution**:
    1.  **Actuator Modeling**: Improve the fidelity of actuator models in simulation.
    2.  **System ID for Actuators**: Use system identification to characterize real actuator behavior (e.g., friction models, maximum torque).
    3.  **Low-Level Controller Tuning**: Retune the real robot's joint-level controllers (PID, impedance).
    4.  **Adaptation**: Use techniques like online adaptation or model-predictive control that can compensate for real-world discrepancies.

### 46. Domain randomization not effective enough

-   **Symptom**: Despite using DR, the policy still struggles with real-world variations.
-   **Root Cause**: The randomized domain in simulation does not sufficiently cover the true distribution of the real world.
-   **Solution**:
    1.  **Expand DR Ranges**: Broaden the min/max ranges for randomized parameters.
    2.  **Add New Randomizations**: Introduce randomization for parameters previously considered static (e.g., adding wind effects, object deformations).
    3.  **Structured Randomization**: Instead of purely random, use techniques like procedural generation to create more structured but diverse environments.
    4.  **Real Data Analysis**: Analyze real-world data to identify unmodeled variations that need to be incorporated into DR.

### 47. Sim environment too simplistic

-   **Symptom**: The simulation lacks enough detail or complexity to prepare the policy for real-world interactions.
-   **Root Cause**: Over-simplification of physical interactions, environment geometry, or sensor models.
-   **Solution**:
    1.  **Increase Fidelity**: Use more complex physics models (e.g., finer collision meshes, accurate material properties).
    2.  **Procedural Generation**: Generate more diverse and realistic environments procedurally.
    3.  **Real-World Asset Integration**: Import 3D models of real-world objects and environments into simulation.
    4.  **Sensor Modeling**: Add more realistic sensor models, including lens distortions, blur, and realistic noise profiles.

### 48. Calibration mismatch between real robot and URDF

-   **Symptom**: The robot's actual joint positions or end-effector pose do not match what is reported by its URDF model.
-   **Root Cause**: Imperfect robot manufacturing, wear and tear, or incorrect sensor-to-base frame transforms.
-   **Solution**:
    1.  **Robot Calibration**: Perform precise kinematic and dynamic calibration of the real robot.
    2.  **Sensor Calibration**: Calibrate all sensors (e.g., camera intrinsics/extrinsics, LiDAR-to-base frame).
    3.  **URDF Update**: Update the URDF with the calibrated parameters.

### 49. Latency issues in real robot control loop

-   **Symptom**: The robot's control loop is not operating at the desired frequency, leading to jerky movements or instability.
-   **Root Cause**: Computational bottlenecks, high data transfer rates, or operating system scheduling issues.
-   **Solution**:
    1.  **Optimize Code**: Profile and optimize control algorithms for speed.
    2.  **Reduce Data**: Minimize the amount of data transferred over ROS 2 topics.
    3.  **Real-Time OS**: Use a real-time Linux kernel or a dedicated RTOS for critical control loops.
    4.  **Hardware Upgrade**: Use a more powerful onboard computer (e.g., Jetson AGX Orin) for complex computations.

### 70. Catkin/ROS 1 packages interfering with ROS 2

-   **Symptom**: Unpredictable behavior, build errors, or `ros2` commands failing after interacting with a ROS 1/Catkin environment.
-   **Root Cause**: Conflicting environment variables and library paths from ROS 1 setup scripts.
-   **Solution**:
    1.  **Never source ROS 1 and ROS 2 in the same terminal.**
    2.  Open a fresh terminal for each ROS version.
    3.  Explicitly unset ROS 1 environment variables before sourcing ROS 2.

## Dependency Resolution & NVIDIA Driver Specific Issues (Continued)

### 71. `rosdep` fails to update due to GPG key errors

-   **Symptom**: `rosdep update` returns errors about missing or invalid GPG keys for repositories.
-   **Root Cause**: The GPG key used to sign the ROS repository has expired or is not installed.
-   **Solution**: Re-add the ROS GPG key:
    ```bash
    sudo apt-key adv --keyserver 'hkp://keyserver.ubuntu.com:80' --recv-key C1CF6E31E6BADE8868B172B45523BAEEB01FA116
    rosdep update
    ```
    *(Note: The key might change over time, always refer to official ROS documentation for the latest key).*

### 72. `dpkg` error "subprocess installed post-installation script returned error exit status"

-   **Symptom**: `sudo apt install` or `sudo apt upgrade` fails during package configuration.
-   **Root Cause**: A package's post-installation script failed, often due to unmet dependencies, corrupted files, or environmental issues.
-   **Solution**:
    1.  Force fix broken installations: `sudo apt install -f`
    2.  Reconfigure pending packages: `sudo dpkg --configure -a`
    3.  If a specific package is causing the issue, try reinstalling it: `sudo apt install --reinstall <package-name>`.

### 73. `apt` error "E: Sub-process /usr/bin/dpkg returned an error code (1)"

-   **Symptom**: General `apt` error indicating a problem with `dpkg`.
-   **Root Cause**: Similar to entry #72, often a corrupted package database or a failing script.
-   **Solution**:
    1.  Clean up: `sudo rm -rf /var/lib/apt/lists/*`
    2.  Update: `sudo apt update`
    3.  Fix broken: `sudo apt install -f`
    4.  Reconfigure: `sudo dpkg --configure -a`

### 74. NVIDIA driver blacklisted by kernel

-   **Symptom**: `nvidia-smi` works, but the X server (desktop environment) fails to start after driver installation. Logs might show `NVRM: GPU 0000:01:00.0: RmInitAdapter failed!`.
-   **Root Cause**: The open-source `nouveau` driver is blacklisting the proprietary NVIDIA driver.
-   **Solution**: Manually blacklist `nouveau`.
    1.  Create `/etc/modprobe.d/blacklist-nouveau.conf`:
        ```
        blacklist nouveau
        options nouveau modeset=0
        ```
    2.  Update initramfs: `sudo update-initramfs -u`
    3.  Reboot: `sudo reboot`

### 75. Dual-boot (Windows/Ubuntu) display issues after NVIDIA driver install

-   **Symptom**: After installing NVIDIA drivers in Ubuntu, Windows display settings are corrupted, or vice-versa.
-   **Root Cause**: UEFI/BIOS settings conflicting, or Fast Boot in Windows interfering.
-   **Solution**:
    1.  Disable **Fast Startup** in Windows (Control Panel > Power Options > Choose what the power buttons do > Change settings that are currently unavailable).
    2.  Disable **Fast Boot** in your motherboard's UEFI/BIOS settings.
    3.  Ensure you boot into each OS at least once after driver changes.

### 76. `docker run` fails with "no space left on device" (even with space)

-   **Symptom**: Docker commands fail, but `df -h` shows plenty of disk space.
-   **Root Cause**: Docker's internal storage (often in `/var/lib/docker`) is using a separate volume or has run out of inodes.
-   **Solution**:
    1.  Check Docker's disk usage: `docker system df`
    2.  Clean up unused Docker objects: `docker system prune -a`
    3.  Consider moving Docker's data root to a larger disk if needed.

### 77. `Python.h` header file not found (for C++ extensions)

-   **Symptom**: When compiling a C++ ROS 2 package with Python bindings, the build fails with `Python.h: No such file or directory`.
-   **Root Cause**: Python development headers are not installed.
-   **Solution**: Install the Python 3 development package: `sudo apt install python3-dev`.

### 78. ROS 2 `PYTHONPATH` issues in mixed environments

-   **Symptom**: Python-based ROS 2 nodes or launch files fail with `ModuleNotFoundError` for custom packages.
-   **Root Cause**: Your custom Python package is not found in the `PYTHONPATH` or there are conflicts with other Python environments (e.g., Anaconda).
-   **Solution**:
    1.  Ensure you always source the `install/setup.bash` (or `setup.zsh`) from your ROS 2 workspace in a fresh terminal.
    2.  Avoid mixing `conda` and ROS 2 environments unless carefully managed. Use `pip install` with `--prefix` or inside a virtual environment for non-ROS Python packages.

### 79. `setup.bash` not found after ROS 2 install

-   **Symptom**: You can't `source /opt/ros/jazzy/setup.bash` because the file doesn't exist.
-   **Root Cause**: ROS 2 was not fully installed, or the installation process encountered an error.
-   **Solution**: Re-run the ROS 2 installation steps from Chapter 2 carefully, ensuring no errors are reported. Check internet connectivity during installation.

### 80. `ament_cmake` build fails for C++ packages

-   **Symptom**: C++ ROS 2 packages fail to build with `ament_cmake` with errors related to CMake or compilers.
-   **Root Cause**: Missing CMake, `build-essential`, or specific C++ compiler dependencies.
-   **Solution**: Ensure you have `build-essential` and `cmake` installed: `sudo apt install build-essential cmake`.

### 81. Generic NVIDIA Driver Installation Failure

-   **Symptom**: Installation of NVIDIA drivers fails with various cryptic errors.
-   **Root Cause**: Conflicts with old drivers, secure boot enabled, or kernel header mismatch.
-   **Solution**:
    1.  **Purge Old Drivers**: `sudo apt purge nvidia-*`
    2.  **Disable Secure Boot**: Access your UEFI/BIOS settings and disable Secure Boot.
    3.  **Install Kernel Headers**: `sudo apt install linux-headers-$(uname -r)`
    4.  **Install via `ubuntu-drivers`**: `sudo ubuntu-drivers autoinstall && sudo reboot`

### 82. Display issues after NVIDIA driver installation (low resolution, freezes)

-   **Symptom**: After installing NVIDIA drivers, the display is stuck at low resolution, or the system freezes at boot.
-   **Root Cause**: Driver is incompatible with your GPU/kernel, or Xorg configuration is corrupted.
-   **Solution**:
    1.  Boot into recovery mode or a TTY (Ctrl+Alt+F1-F6).
    2.  Uninstall the driver: `sudo apt purge nvidia-*`
    3.  Reinstall a known compatible version or use `ubuntu-drivers autoinstall`.
    4.  If in TTY, restart lightdm/gdm: `sudo systemctl restart display-manager`.

### 83. CUDA toolkit installation fails or is incompatible with driver

-   **Symptom**: CUDA examples fail to compile/run, or `nvcc` reports driver incompatibility.
-   **Root Cause**: The installed CUDA Toolkit version is not compatible with your NVIDIA driver version.
-   **Solution**:
    1.  **Check Compatibility**: Refer to the NVIDIA CUDA Toolkit documentation for the compatibility matrix between CUDA, drivers, and GCC versions.
    2.  **Install Compatible Versions**: Ensure you install a driver version that is compatible with your desired CUDA version, or vice-versa.
    3.  **PPA vs .run file**: Using the NVIDIA driver PPA and `apt install cuda` usually handles compatibility better than manual `.run` files.

### 84. NVIDIA GPU not visible to applications (e.g., PyTorch, TensorFlow)

-   **Symptom**: Deep learning frameworks (PyTorch, TensorFlow) report no GPU found or use CPU despite a working NVIDIA driver and CUDA.
-   **Root Cause**: Missing framework-specific CUDA/cuDNN dependencies or incorrect environment setup.
-   **Solution**:
    1.  **Install cuDNN**: `sudo apt install libcudnn8 libcudnn8-dev` (version should match CUDA).
    2.  **Verify PyTorch/TensorFlow**: Ensure you installed the GPU-enabled versions of these frameworks.
    3.  **Environment Variables**: Double-check `LD_LIBRARY_PATH` and `PATH` include CUDA paths.

### 85. Power limit or throttling issues with NVIDIA GPU

-   **Symptom**: GPU performance is lower than expected, or `nvidia-smi` reports `PerfCap Reason: Pwr`.
-   **Root Cause**: GPU hitting its power limit, thermal throttling, or configured to a lower power state.
-   **Solution**:
    1.  **Cooling**: Ensure adequate cooling for your GPU. Clean dust from fans.
    2.  **Power Mode**: Increase power limit using `sudo nvidia-smi -pl <watts>`.
    3.  **Performance Mode**: Set to maximum performance using `sudo nvidia-smi -pm ENABLED`.
    4.  **Monitor**: Use `nvidia-smi -l 1` to continuously monitor usage, temp, and power.